document.addEventListener("DOMContentLoaded", function () {
    const burger = document.querySelector(".js-burger");
    const nav = document.querySelector(".js-nav");
    const navClose = document.querySelector(".js-navClose");
    const header = document.querySelector(".js-header");

    if (burger) {
        burger.addEventListener("click", function () {
            burger.classList.toggle("active");
            header.classList.toggle("active");
            nav.classList.toggle("active");

            if (nav.classList.contains("active")) {
                wrapperFixPosition();
            } else {
                wrapperUnfixPosition();
            }
        });
        navClose.addEventListener("click", function () {
            burger.classList.remove("active");
            header.classList.remove("active");
            nav.classList.remove("active");
            wrapperUnfixPosition();
        });
        document.addEventListener("click", function (event) {
            if (!nav.contains(event.target) && !burger.contains(event.target) && nav.classList.contains("active")) {
                burger.classList.remove("active");
                header.classList.remove("active");
                nav.classList.remove("active");
                wrapperUnfixPosition(); // при закрытии меню
            }
        });
    
    
        const toggles = document.querySelectorAll('.js-navToggle')
        toggles.forEach(function (toggle) {
            toggle.addEventListener('click', function () {
                let navItem = this.closest('.js-navItem');
                navItem.classList.toggle('active');
            });
        });
    }
});

document.addEventListener("DOMContentLoaded", function () {
    const sliderEvents = document.querySelector(".js-sliderEvents");
    let swiperEvents; 

    function initSliderEvents() {
        if (window.innerWidth < 768) {
            if (!swiperEvents) { 
                swiperEvents = new Swiper(sliderEvents, {
                    autoHeight: true,
                    spaceBetween: 16,
                    pagination: {
                        el: '.swiper-pagination-events',
                        clickable: true,
                    }
                });
            }
        } else {
            if (swiperEvents) {
                swiperEvents.destroy();
                swiperEvents = null; 
            }
        }
    }

    window.addEventListener('resize', initSliderEvents);
    window.addEventListener('load', initSliderEvents);
});

document.addEventListener("DOMContentLoaded", function () {
    const sliderMaster = document.querySelector(".js-sliderMaster");
    let swiperMaster; 

    function initSwiperMaster() {
        if (window.innerWidth < 768) {
            if (!swiperMaster) { 
                swiperMaster = new Swiper(sliderMaster, {
                    autoHeight: true,
                    spaceBetween: 16,
                    pagination: {
                        el: '.swiper-pagination-masters',
                        clickable: true,
                    }
                });
            }
        } else {
            if (swiperMaster) {
                swiperMaster.destroy();
                swiperMaster = null; 
            }
        }
    }

    window.addEventListener('resize', initSwiperMaster);
    window.addEventListener('load', initSwiperMaster);
});

const scrollUpBtn = document.querySelector('.js-scrollUp');
const footer = document.querySelector('footer');

const showButtonThreshold = window.innerHeight;

const scrollHandler = () => {
    const scrollY = window.scrollY;
    const footerRect = footer.getBoundingClientRect();
    const buttonHeight = scrollUpBtn.offsetHeight;

    if (scrollY > showButtonThreshold) {
        scrollUpBtn.classList.add('show');
    } else {
        scrollUpBtn.classList.remove('show');
    }

    if (footerRect.top < window.innerHeight) {
        scrollUpBtn.classList.add('fixed');
        scrollUpBtn.style.bottom = `${window.innerHeight - footerRect.top + 40}px`;
    } else {
        scrollUpBtn.classList.remove('fixed');
        scrollUpBtn.style.bottom = '40px';
    }
};

const scrollToTop = () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
};
if (scrollUpBtn) {
    scrollUpBtn.addEventListener('click', scrollToTop);
    window.addEventListener('scroll', scrollHandler);
}
function wrapperFixPosition() {
    const fixBlocks = document.querySelectorAll('.js-fixBlock');
    let paddingOffset = window.innerWidth - document.querySelector('body').offsetWidth + 'px';
    setTimeout(function () {
        if (!document.querySelector('body').hasAttribute('wrapper-body-scroll-fix')) {
            let scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
            fixBlocks.forEach((el) => {
                el.style.paddingRight = paddingOffset;
            });
            document.querySelector('body').style.overflow = 'hidden';
            document.querySelector('body').setAttribute('wrapper-body-scroll-fix', scrollPosition);
            document.querySelector('body').style.overflow = 'hidden';
            document.querySelector('body').style.position = 'fixed';
            //document.querySelector('body').style.top = '-' + scrollPosition + 'px';
            document.querySelector('body').style.top = '0';
            document.querySelector('body').style.left = '0';
            document.querySelector('body').style.width = '100%';
            document.querySelector('body').style.paddingRight = paddingOffset;
        }
    }, 15);
}
function wrapperUnfixPosition() {
    const fixBlocks = document.querySelectorAll('.js-fixBlock');
    if (document.querySelector('body').hasAttribute('wrapper-body-scroll-fix')) {
        let scrollPosition = document.querySelector('body').getAttribute('wrapper-body-scroll-fix');
        document.querySelector('body').removeAttribute('wrapper-body-scroll-fix');
        document.querySelector('body').style.overflow = '';
        document.querySelector('body').style.position = '';
        document.querySelector('body').style.top = '';
        document.querySelector('body').style.left = '';
        document.querySelector('body').style.width = '';
        window.scroll(0, scrollPosition);
        fixBlocks.forEach((el) => {
            el.style.paddingRight = '0px';
        });
        document.querySelector('body').style.paddingRight = '0px';
    }
}